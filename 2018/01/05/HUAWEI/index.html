<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.2" />






<meta name="description" content="一、基本知识基础操作1.sysname   R1    命名设备(sy R1)  interface  g 0/0/0   (int g 0/0/0) ip address  192.168.1.1/24 （ip ad xxx） display this 查看当前设备的配置信息(dis this) undo info-center  enable   关闭信息中心 （默认开启）  12345und">
<meta property="og:type" content="article">
<meta property="og:title" content="HUAWEI路由器实训">
<meta property="og:url" content="http://yoursite.com/2018/01/05/HUAWEI/index.html">
<meta property="og:site_name" content="DF104&#39;S BLOG">
<meta property="og:description" content="一、基本知识基础操作1.sysname   R1    命名设备(sy R1)  interface  g 0/0/0   (int g 0/0/0) ip address  192.168.1.1/24 （ip ad xxx） display this 查看当前设备的配置信息(dis this) undo info-center  enable   关闭信息中心 （默认开启）  12345und">
<meta property="og:image" content="https://wx2.sinaimg.cn/mw1024/786be24dgy1fn3o3otfb8j20km06taa4.jpg">
<meta property="og:image" content="https://wx2.sinaimg.cn/mw1024/786be24dgy1fn3o3osrrcj20i605nq2y.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/mw1024/786be24dgy1fn3o3orj0oj20lm0e4t9j.jpg">
<meta property="og:image" content="https://wx2.sinaimg.cn/mw1024/786be24dgy1fn3o3otca4j20jr0kfabe.jpg">
<meta property="og:image" content="https://wx4.sinaimg.cn/mw1024/786be24dgy1fn3o3opl6wj20gu03bdfr.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/mw1024/786be24dgy1fn3o3pq6jlj20hi078jrj.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/mw1024/786be24dly1fn4f7e8lkoj20p60b4wfd.jpg">
<meta property="og:image" content="https://wx3.sinaimg.cn/mw1024/786be24dly1fn4l6w33e3j20j9044t8r.jpg">
<meta property="og:image" content="https://wx3.sinaimg.cn/mw1024/786be24dly1fn4l6wf7hhj20ga058748.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/mw1024/786be24dly1fn4l6w5o95j20f704o3yh.jpg">
<meta property="og:image" content="https://wx4.sinaimg.cn/mw1024/786be24dly1fn4nv6h9zej20rw0k8796.jpg">
<meta property="og:image" content="https://wxt.sinaimg.cn/mw1024/786be24dly1fn4nsewo5gj20kr0fbq70.jpg?tags=%5B%5D">
<meta property="og:image" content="https://wx3.sinaimg.cn/mw1024/786be24dly1fn5hv5osn6j20ef0c2jrw.jpg">
<meta property="og:image" content="https://wx4.sinaimg.cn/mw1024/786be24dly1fn5hv5o80cj20ex03paa1.jpg">
<meta property="og:image" content="https://wx3.sinaimg.cn/mw1024/786be24dly1fn5njvqmugj20lw07tt94.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/mw1024/786be24dly1fn5nxx66uhj20i8099glv.jpg">
<meta property="og:image" content="https://wx2.sinaimg.cn/mw1024/786be24dly1fn5rnqwagej20hw0aawf4.jpg">
<meta property="og:image" content="https://wx4.sinaimg.cn/mw1024/786be24dgy1fn5wyoiuf1j20rg09vmy5.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/mw1024/786be24dgy1fn5wyoj3ukj20bh07baa6.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn908iia1vj20j30b6t9p.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn904iacdqj20h808qwf0.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn904iacdqj20h808qwf0.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn90njb598j20cg02pdfp.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn987bfd6kj20j5068q39.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn9bw7wi8wj20r506ljs3.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn9c6qvht2j20jb0cf74t.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn9cazvvzmj20fs07kaao.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn9bw7wi8wj20r506ljs3.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn9c6qvht2j20jb0cf74t.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dgy1fn9cazvvzmj20fs07kaao.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/786be24dly1fna4mcz9c3j20rs0ac75d.jpg">
<meta property="og:updated_time" content="2018-01-09T13:34:36.478Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HUAWEI路由器实训">
<meta name="twitter:description" content="一、基本知识基础操作1.sysname   R1    命名设备(sy R1)  interface  g 0/0/0   (int g 0/0/0) ip address  192.168.1.1/24 （ip ad xxx） display this 查看当前设备的配置信息(dis this) undo info-center  enable   关闭信息中心 （默认开启）  12345und">
<meta name="twitter:image" content="https://wx2.sinaimg.cn/mw1024/786be24dgy1fn3o3otfb8j20km06taa4.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/01/05/HUAWEI/"/>





  <title>HUAWEI路由器实训 | DF104'S BLOG</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6031694ddced3d853aa2a249541ce520";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">DF104'S BLOG</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/05/HUAWEI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DF104">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DF104'S BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">HUAWEI路由器实训</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-05T10:01:38+08:00">
                2018-01-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="一、基本知识"><a href="#一、基本知识" class="headerlink" title="一、基本知识"></a>一、基本知识</h2><h3 id="基础操作"><a href="#基础操作" class="headerlink" title="基础操作"></a>基础操作</h3><p>1.sysname   R1    命名设备(sy R1)</p>
<ol>
<li>interface  g 0/0/0   (int g 0/0/0)</li>
<li>ip address  192.168.1.1/24 （ip ad xxx）</li>
<li>display this 查看当前设备的配置信息(dis this)</li>
<li>undo info-center  enable   关闭信息中心 （默认开启）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">undo info-center enbale //关闭信息中心</div><div class="line">[R2]sysname R1 //命名路由器</div><div class="line">[R1]interface GigabitEthernet0/0/0//打开1000Mbps接口0/0/0</div><div class="line">[R1-GigabitEthernet0/0/0]ip address 192.168.1.2 24//配置ip地址为192.168.1.1 255.255.255.0</div><div class="line">[R1]display this //查看当前设备的配置信息</div></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="linux-权限位信息"><a href="#linux-权限位信息" class="headerlink" title="linux 权限位信息"></a>linux 权限位信息</h3><p>用ls命令所得到的表示法的格式是类似这样的：-rwxr-xr-x 。下面解析一下格式所表示的意思。这种表示方法一共有十位： </p>
<p>　　9 8 7 6 5 4 3 2 1 0 </p>
<p>​        d  r w x  r -  x  r - x </p>
<p>　　第9位表示文件类型,可以为p、d、l、s、c、b和-： </p>
<p>　　p表示命名管道文件 </p>
<p>　　d表示目录文件 </p>
<p>　　l表示符号连接文件 </p>
<p>　　-表示普通文件 </p>
<p>　　s表示socket文件 </p>
<p>　　c表示字符设备文件 </p>
<p>　　b表示块设备文件 </p>
<p>　　第8-6位、5-3位、2-0位分别表示文件所有者的权限，同组用户的权限，其他用 户的权限，其形式为rwx： </p>
<p>　　r表示可读，可以读出文件的内容 </p>
<p>　　w表示可写，可以修改文件的内容 </p>
<p>　　x表示可执行，可运行这个程序 </p>
<h3 id="华为系统基础命令"><a href="#华为系统基础命令" class="headerlink" title="华为系统基础命令"></a>华为系统基础命令</h3><p><strong>tips</strong>:</p>
<ol>
<li>undo取命令的反向</li>
<li>配置文件的删除等于恢复出厂设置</li>
</ol>
<p>cd  进入目录</p>
<p>pwd 显示当前路径</p>
<p>dir 显示当前目录文件</p>
<p>mkdir 创建文件夹</p>
<p>rmdir 删除文件夹</p>
<p>undelete  从回收站找回文件</p>
<p>save 保存配置</p>
<p>display saved-configuration查看保存的文件</p>
<p>reset saved-configuration 恢复出厂设置</p>
<p>dis current-configuration xxx 只显示xxx的设置（dis cu config xxx）</p>
<p>reboot 重启设备</p>
<p>compare configuration 对比当前文件和配置文件的差异</p>
<p>? 查看当前用户的命令解释</p>
<p>language-mode Chinese 更改系统语言为中文</p>
<p>language-mode English 更改系统语言为英文</p>
<p>display ip interface brief  查看接口ip地址(dis ip int brief)</p>
<p>display tcp status 查看tcp的信息</p>
<h2 id="二、FTP的配置"><a href="#二、FTP的配置" class="headerlink" title="二、FTP的配置"></a>二、<a href="https://baike.baidu.com/item/ftp/13839" target="_blank" rel="external">FTP</a>的配置</h2><h3 id="FTP文件传输协议"><a href="#FTP文件传输协议" class="headerlink" title="FTP文件传输协议"></a>FTP文件传输协议</h3><p>使用TCP 20/21端口</p>
<p>20是数据端口（主动模式下使用） </p>
<p>21是控制端口</p>
<p>存在安全问题  因为账户和密码都是明文传输 </p>
<h3 id="FTP基础命令"><a href="#FTP基础命令" class="headerlink" title="FTP基础命令"></a>FTP基础命令</h3><p>! -    执行本地命令</p>
<p>? -    显示FTP命令的说明</p>
<p>append -   向远程服务器追加本地文件</p>
<p>ascii -   设置文件传输类型为ASCII，默认类型</p>
<p>bell -    每一个传输命令完成触发一次响铃（默认关闭）</p>
<p>binary -   设置文件传输类型为binary（二进制传输） </p>
<p>bye -     结束FTP会话并退出</p>
<p>cd -   改变远程工作目录</p>
<p>close -   结束FTP会话并返回命令行</p>
<p>debug -   开关调试（默认关闭）</p>
<p>delete -   删除远程单个文件</p>
<p>dir -   显示远程目录文件盒子目录列表</p>
<p>disconnect -  从远程断开，重新获得FTP提示框</p>
<p>get -   复制单个远程文件到本地</p>
<p>glob -      开关文件名通配符（默认ON）</p>
<p>hash - Toggles hash-sign (#) printing for each data block transferred (default = OFF) 为每个缓冲区传输切换打印“#”（哈希标记打印）</p>
<p>help -  显示FTP命令帮助信息（用法通”?“）</p>
<p>lcd -   改变本地工作目录</p>
<p>literal - Sends arguments, verbatim, to the remote FTP server 向远程FTP服务器逐字发送参数（发送任意 ftp 命令）</p>
<p>ls -  显示远程目录文件和子目录的简短列表（只有文件名和目录名）</p>
<p>mdelete -   删除远程一个或多个文件</p>
<p>mdir -   列出多个远程目录的内容</p>
<p>mget -  复制一个或多个远程文件至本地</p>
<p>mkdir -  创建一个远程目录</p>
<p>mls -  列出多个远程目录的内容</p>
<p>mput -  复制一个或多个本地文件到远程</p>
<p>open -  连接到指定的FTP服务器</p>
<p>prompt -  开关交互提示（默认为ON）</p>
<p>put -  复制一个本地文件到远程</p>
<p>pwd -   显示远程当前工作目录（字面意思：打印工作目录）</p>
<p>quit -   结束FTP会话并退出FTP（功能通bye）</p>
<p>quote - Sends arguments, verbatim, to the remote FTP server (same as “literal”) 发送任意 ftp 命令？？</p>
<p>recv -  复制远程文件到本地</p>
<p>remotehelp - 显示远程命令帮助</p>
<p>rename -   重命名远程文件</p>
<p>rmdir -  删除远程目录</p>
<p>send -   复制一个本地文件到远程（功能通put）</p>
<p>status -  显示当前FTP连接状态</p>
<p>trace -  开关数据包追踪（默认为OFF）</p>
<p>type -  设置文件传输类型（默认为ASCII）</p>
<p>user -  发送新用户信息</p>
<p>verbose -    开关详细模式</p>
<h4 id="1、FTP-Server的配置"><a href="#1、FTP-Server的配置" class="headerlink" title="1、FTP Server的配置"></a>1、FTP Server的配置</h4><p><strong>R1的配置</strong></p>
<p><em>AAA : 认证(准入机制)、授权(给予接入的用户权限)、计费</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[R1]ftp server enable//启用ftp服务</div><div class="line">[R1]AAA //进入AAA认证</div><div class="line">[R1-aaa]local-user hcie password cipher 123456 //设定认证用户hcie和密码123456</div><div class="line">[R1-aaa]local-user hcie service-type ftp //授权只允许使用ftp</div><div class="line">[R1-aaa]local-user hcie ftp-directory flash: //设置ftp目录(flash:/dhcp/)华为设备中的文件存储</div></pre></td></tr></table></figure>
<h4 id="2、FTP-Cilent的配置"><a href="#2、FTP-Cilent的配置" class="headerlink" title="2、FTP Cilent的配置"></a>2、FTP Cilent的配置</h4><p><em>注意：ftp需要在用户模式下进行使用</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;R2&gt;ftp 192.168.1.1//打开服务器</div><div class="line">[ftp]put flash:/dhcp/dhcp-duid.txt //上传文件</div><div class="line">[ftp]pwd //显示当前路径</div><div class="line">[ftp]dir //显示当前目录下的文件</div><div class="line">...</div></pre></td></tr></table></figure>
<h2 id="三、Telnet的配置"><a href="#三、Telnet的配置" class="headerlink" title="三、Telnet的配置"></a>三、<a href="https://baike.baidu.com/item/Telnet" target="_blank" rel="external">Telnet</a>的配置</h2><p><em>Telnet服务默认开启</em></p>
<p>telnet权限  取值范围 0-15（取决于支持范围）</p>
<p>权限：</p>
<p>0级，参观级：网络诊断工具命令（ping、tracert）、从本设备出发访问外部设备的命令（Telnet客户端）等。</p>
<p>1级，监控级：用于系统维护，包括display等命令。</p>
<p>2级，配置级：业务配置命令，包括路由、各个网络层次的命令，向用户提供直接网络服务。</p>
<p>3级，管理级：用于系统基本运行的命令，对业务提供支撑作用，包括文件系统、FTP、TFTP、Xmodem下载、配置文件切换命令、备板控制命令、用户管理命令、命令级别设置命令、系统内部参数设置命令；用于业务故障诊断的debugging命令等</p>
<h3 id="登录Telnet"><a href="#登录Telnet" class="headerlink" title="登录Telnet"></a>登录Telnet</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;R2&gt;telnet 192.168.1.1 //登录位于192.168.1.1的telnet服务器</div></pre></td></tr></table></figure>
<h3 id="password模式"><a href="#password模式" class="headerlink" title="password模式"></a>password模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[R1]telnet server enable //启用Telnet服务</div><div class="line">[R1]user-interface vty 0 4 //创建可以最多登录5台设备的telnet服务器</div><div class="line">[R1-ui-vty0-4]authentication-mode password  //选择模式为 password的密码</div><div class="line">[R1-ui-vty0-4]set authentication password simple 123456 //设置密码模式和密码</div><div class="line">[R1-ui-vty0-4]user privilege level 2 //设置权限级别为2</div></pre></td></tr></table></figure>
<h3 id="AAA模式"><a href="#AAA模式" class="headerlink" title="AAA模式"></a>AAA模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[R1-ui-vty0-4]authentication-mode aaa //AAA模式</div><div class="line">[R1]AAA //进入AAA认证</div><div class="line">[R1-aaa]local-user telnet password cipher 123456 //设定认证用户telnet和密码123456</div><div class="line">[R1-aaa]local-user telnet service-type telnet //授权只允许使用telnet</div><div class="line">[R1-aaa]local-user telnet privilege level 3  //对3a认证的用户进行权限的更改</div></pre></td></tr></table></figure>
<h2 id="四、控制台配置"><a href="#四、控制台配置" class="headerlink" title="四、控制台配置"></a>四、控制台配置</h2><h3 id="设置控制台密码"><a href="#设置控制台密码" class="headerlink" title="设置控制台密码"></a>设置控制台密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[R1]user-interface console 0 //进入管理0端</div><div class="line">[R1-ui-console0]authentication-mode password //认证模式</div><div class="line">[R1-ui-console0]set authentication password simple 123456 //设置密码</div></pre></td></tr></table></figure>
<h3 id="设置超时时间"><a href="#设置超时时间" class="headerlink" title="设置超时时间"></a>设置超时时间</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[R1-ui-console0]idle-timeout  //无操作等待延时</div><div class="line">[R1-ui-console0]idle-timeout  0 10 //设置10s延迟</div></pre></td></tr></table></figure>
<h2 id="五、路由"><a href="#五、路由" class="headerlink" title="五、路由"></a>五、路由</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p><strong>路由</strong> 源节点 到 目标节点 进行路径选择的过程</p>
<p><strong>路由器</strong>   在此过程中负责选路的网络设备</p>
<p><strong>路由技术</strong>  如何确定一条最佳路径的方法</p>
<p><strong>路由表 </strong>（直连和非直连需要配置<em>静态路由和动态路由</em>来进行学习）形成）</p>
<p><strong>下一跳</strong>  下一次数据提交的地方;对端设备接口的IP地址</p>
<p><strong>全网互通</strong>  所有路由器路由表一致的状态  所有路由器的路由表要拥有所有网段的条目</p>
<p>​                   <strong>Tips:</strong>如果某个路由器有路由条目的缺失 就会导致数据不可达</p>
<p><strong>IP配置</strong> 相同链路 相同网段 ;不同接口不同网段(如下图)</p>
<h3 id="图表及命令"><a href="#图表及命令" class="headerlink" title="图表及命令"></a>图表及命令</h3><p><img src="https://wx2.sinaimg.cn/mw1024/786be24dgy1fn3o3otfb8j20km06taa4.jpg" alt="路由器连接"></p>
<h3 id="静态路由的配置"><a href="#静态路由的配置" class="headerlink" title="静态路由的配置"></a>静态路由的配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[Huawei]int LoopBack 1 //配置路由回环地址</div><div class="line">[Huawei]ip route-static  192.168.3.0 24 192.168.2.2 //静态路由配置</div></pre></td></tr></table></figure>
<p><img src="https://wx2.sinaimg.cn/mw1024/786be24dgy1fn3o3osrrcj20i605nq2y.jpg" alt="路由表"></p>
<p>Proto 路由方式</p>
<p>Pre 优先级</p>
<p>Cost 消耗值</p>
<p>NextHop 下一跳</p>
<p>Interface 出口</p>
<table>
<thead>
<tr>
<th style="text-align:center">Proto</th>
<th style="text-align:center">Pre（优先级）</th>
<th style="text-align:center">Cost</th>
<th style="text-align:center">NextHop</th>
<th style="text-align:center">Interface</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">路由方式</td>
<td style="text-align:center">0-255</td>
<td style="text-align:center">消耗值</td>
<td style="text-align:center">下一跳</td>
<td style="text-align:center">出口</td>
</tr>
</tbody>
</table>
<p><strong>华为路由器默认优先级</strong> </p>
<table>
<thead>
<tr>
<th style="text-align:center">DIRECT</th>
<th style="text-align:center">OSPF</th>
<th style="text-align:center">IS-IS</th>
<th style="text-align:center">Static</th>
<th style="text-align:center">RIP</th>
<th style="text-align:center">IBGP</th>
<th style="text-align:center">OSPF  ASE/import</th>
<th style="text-align:center">EBGP</th>
<th style="text-align:center">UNKNOWN</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">10</td>
<td style="text-align:center">15</td>
<td style="text-align:center">60</td>
<td style="text-align:center">100</td>
<td style="text-align:center">130</td>
<td style="text-align:center">150</td>
<td style="text-align:center">170</td>
<td style="text-align:center">255</td>
</tr>
</tbody>
</table>
<h3 id="默认路由的配置"><a href="#默认路由的配置" class="headerlink" title="默认路由的配置"></a>默认路由的配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[LSW1]ip route-static 0.0.0.0 0 192.168.3.1 //默认路由只适用于末梢网络</div></pre></td></tr></table></figure>
<p>默认路由适用于末梢网络</p>
<p><strong>末梢网络</strong> :只有一个网络进出口（边缘网络）</p>
<h3 id="路由汇总"><a href="#路由汇总" class="headerlink" title="路由汇总"></a><a href="https://baike.baidu.com/item/%E8%B7%AF%E7%94%B1%E6%B1%87%E8%81%9A?fromtitle=%E8%B7%AF%E7%94%B1%E6%B1%87%E6%80%BB&amp;fromid=7996986" target="_blank" rel="external">路由汇总</a></h3><p>192.168.1.0</p>
<p>192.168.2.0 </p>
<p>汇总为 192.168.0.0/22  </p>
<h3 id="RIP的配置"><a href="#RIP的配置" class="headerlink" title="RIP的配置"></a>RIP的配置</h3><p><em>路由器所有直连网段全部 net  xxx.xxx.xxx.xxx</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[Huawei]rip</div><div class="line">[Huawei-rip-1]net 192.168.2.0  //设置192.168.2.0为直连网段</div><div class="line">[Huawei-rip-1]preference 50 //调整动态路由的优先级为50 动态路由默认优先级为100</div></pre></td></tr></table></figure>
<h4 id="配置接口的附加度量值"><a href="#配置接口的附加度量值" class="headerlink" title="配置接口的附加度量值"></a>配置接口的附加度量值</h4><h5 id="背景信息"><a href="#背景信息" class="headerlink" title="背景信息"></a>背景信息</h5><p>通过调整RIP接口的附加度量值来影响路由的选择。</p>
<p>附加路由度量值是指在RIP路由原来度量值的基础上所增加的度量值（跳数，等于入口消耗+出口消耗的值）。对于 R IP接收和发布路由，可通过不同的命令配置附加度量值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[R4]int GigabitEthernet 0/0/1 进入接口</div><div class="line">根据需求选择以下两个配置之一</div><div class="line">[R4-GigabitEthernet0/0/1]rip metricin 2 //设置该入口消耗值为3</div><div class="line">[R4-GigabitEthernet0/0/1]rip metricout 3 //设置该出口消耗值为3</div></pre></td></tr></table></figure>
<h3 id="OSPF的配置"><a href="#OSPF的配置" class="headerlink" title="OSPF的配置"></a>OSPF的配置</h3><p><em>Tips:支持区域划分</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[Huawei-rip-1]ospf</div><div class="line">[Huawei-ospf-1]a	</div><div class="line">[Huawei-ospf-1]area 0</div><div class="line">[Huawei-ospf-1-area-0.0.0.0]net 192.168.1.0 0.0.0.255</div></pre></td></tr></table></figure>
<p><em>Tips：在OSPF中，一次性宣告当前设备的所有网段也可以实现上述操作</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[Huawei-ospf-1-area-0.0.0.0]net 192.168.1.0 0.0.0.255</div></pre></td></tr></table></figure>
<p><em>Tips:OSPF网络中Loopback接口默认的网络类型为P2P  学习到的网段掩码是32</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[Huawei]int LoopBack 1</div><div class="line">[Huawei-LoopBack1]ospf network-type broadcast //更改网络类型即可</div></pre></td></tr></table></figure>
<h3 id="路由引入（路由重发布）"><a href="#路由引入（路由重发布）" class="headerlink" title="路由引入（路由重发布）"></a>路由引入（<a href="https://baike.baidu.com/item/%E8%B7%AF%E7%94%B1%E9%87%8D%E5%88%86%E5%8F%91" target="_blank" rel="external">路由重发布</a>）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[R3]ospf</div><div class="line">[R3-ospf-1]import-route static//引入静态路由</div></pre></td></tr></table></figure>
<h3 id="IS-IS配置"><a href="#IS-IS配置" class="headerlink" title="IS-IS配置"></a>IS-IS配置</h3><p><em>Tips:所有使用的接口都要打开isis</em></p>
<p>R1的配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[Huawei]isis</div><div class="line">[Huawei-isis-1]network-entity //NET N-network E-  T  网络实体名称</div><div class="line">[Huawei-isis-1]network-entity 49.0001.0000.0000.0001.00 前面两个是区域 中间三段式路由器 两个0是固定的 用于路由器上支持ip协议的</div><div class="line">[Huawei]int LoopBack 1</div><div class="line">[Huawei-LoopBack1]isis enable</div><div class="line">[Huawei]int G0/0/0</div><div class="line">[Huawei-GigabitEthernet0/0/0]isis enable</div></pre></td></tr></table></figure>
<p>R2的配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[Huawei-isis-1]network-entity 49.0001.0000.0000.0002.00</div></pre></td></tr></table></figure>
<h3 id="BGP配置"><a href="#BGP配置" class="headerlink" title="BGP配置"></a>BGP配置</h3><p><em>Tips:如果邻居的AS和我不一样 说明是我们两个不在同一个网络（EBGP关系），如果一样则为IBGP关系</em></p>
<p><strong>负责传递互联网之间的路由的协议</strong></p>
<p>R1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[Huawei]bgp 100</div><div class="line">[Huawei-bgp]peer 192.168.2.2 as-number 100 //邻居的AS编号</div><div class="line">[Huawei-bgp]network 192.168.1.10 24</div><div class="line">[Huawei-bgp]network 192.168.2.0 24</div></pre></td></tr></table></figure>
<p>BGP的优先级更改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[Huawei-bgp]preference 5 5 5// EBGP IBGP ...优先级</div></pre></td></tr></table></figure>
<h2 id="六、DHCP-动态主机配置协议"><a href="#六、DHCP-动态主机配置协议" class="headerlink" title="六、DHCP 动态主机配置协议"></a>六、<a href="https://baike.baidu.com/item/DHCP" target="_blank" rel="external">DHCP 动态主机配置协议</a></h2><p>实现为接入设备配置网络参数的能力</p>
<h3 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h3><ol>
<li>主机（系统）</li>
<li>设备（网络）</li>
</ol>
<p>系统和网络互为实现</p>
<h3 id="地址池"><a href="#地址池" class="headerlink" title="地址池"></a>地址池</h3><ol>
<li>接口，只为一个网段分配网络参数</li>
<li>全局，为所有网段分配网络参数</li>
</ol>
<h3 id="路由器DHCP配置"><a href="#路由器DHCP配置" class="headerlink" title="路由器DHCP配置"></a>路由器DHCP配置</h3><h4 id="接口地址池配置"><a href="#接口地址池配置" class="headerlink" title="接口地址池配置"></a>接口地址池配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[Huawei]dhcp enable //启用DHCP</div><div class="line">[Huawei]interface g0/0/0 //进入接口</div><div class="line">[Huawei-GigabitEthernet0/0/0]ip address 192.168.1.1 24 //设置端口ip地址</div><div class="line">[Huawei-GigabitEthernet0/0/0]dhcp select interface //将dhcp模式设置为接口地址池模式</div><div class="line">[Huawei-GigabitEthernet0/0/0]dhcp server dns-list 8.8.8.8 //设置DNS服务器地址</div></pre></td></tr></table></figure>
<h4 id="全局地址池配置"><a href="#全局地址池配置" class="headerlink" title="全局地址池配置"></a>全局地址池配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">[Huawei]dhcp enable //启用DHCP</div><div class="line">[Huawei]ip pool hcie //创建ip地址池hcie</div><div class="line">[Huawei-ip-pool-hcie]network 192.168.1.0 mask 24//设置ip地址池</div><div class="line">[Huawei-ip-pool-hcie]gateway-list 192.168.1.1 //设置网关</div><div class="line">[Huawei-ip-pool-hcie]excluded-ip-address 192.168.1.254 //禁用254ip</div><div class="line">[Huawei-ip-pool-hcie]static-bind ip-adstatic-bind ip-address 192.168.1.250 mac 5489-987B-1D7A //设置ip与mac地址绑定</div><div class="line">[Huawei-ip-pool-hcie]lease day 3</div><div class="line">[Huawei-ip-pool-hcie]lease day 3 hour 5 //设置ip地址租期</div><div class="line">[Huawei-ip-pool-hcie]dns-list 8.8.8.8 //设置dns</div><div class="line">[Huawei-GigabitEthernet0/0/0]ip ad 192.168.1.2 24 //设置路由器端口ip</div><div class="line">[Huawei-GigabitEthernet0/0/0]dhcp select global //设置端口的dhcp模式</div><div class="line">[Huawei-ip-pool-hcie]option //其他dhcp的设置</div><div class="line">[Huawei]display ip pool name hcie//查看hcie 的情况</div><div class="line">[Huawei]dis ip pool name hcie used  //查看地址池使用情况</div></pre></td></tr></table></figure>
<h4 id="客户端操作"><a href="#客户端操作" class="headerlink" title="客户端操作"></a>客户端操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ipconfig /realese //删除得到的信息</div><div class="line">ipconfig /renew  //重新获取信息</div></pre></td></tr></table></figure>
<h3 id="路由器DHCP中继的配置"><a href="#路由器DHCP中继的配置" class="headerlink" title="路由器DHCP中继的配置"></a>路由器DHCP中继的配置</h3><p><strong>单播</strong>  一对一，针对性强</p>
<p><strong>广播</strong>  一对所有，便利性</p>
<p><strong>组播</strong>  一对多，两者兼具</p>
<p><strong>入</strong>  目标地址是自己</p>
<p><strong>出</strong>  源地址是自己</p>
<p><strong>转发</strong>  源目的地址都不是自己</p>
<p>客户端与网关设备之间是广播</p>
<p>网关设备与DHCP服务器之间是单播</p>
<p><img src="https://wx1.sinaimg.cn/mw1024/786be24dgy1fn3o3orj0oj20lm0e4t9j.jpg" alt="DHCP中继"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">按照上图配置路由器端口ip地址，所有路由器配置RIP 此过程不再赘述。</div><div class="line">R1路由器配置</div><div class="line">[R1]dhcp enable //打开dhcp服务</div><div class="line">[R1]int GigabitEthernet 0/0/0 //进入端口0/0/0</div><div class="line">[R1-GigabitEthernet0/0/0]dhcp select relay //设置接口为dhcp中继模式</div><div class="line">[R1-GigabitEthernet0/0/0]dhcp relay server-ip 192.168.4.2 //设置中继的dhcp服务器IP地址</div><div class="line">R2路由器的配置</div><div class="line">[R2]dhcp enable //打开DHCP服务</div><div class="line">[R2]int GigabitEthernet 0/0/0</div><div class="line">[R2-GigabitEthernet0/0/0] dhcp select relay //设置该接口为dhcp中继模式</div><div class="line">[R2-GigabitEthernet0/0/0]dhcp relay server-ip 192.168.4.2 //设置要中继的dhcp服务器地址</div><div class="line">R3路由器的配置</div><div class="line">[R3]dhcp enable //打开dhcp服务</div><div class="line">[R3]int GigabitEthernet0/0/2 //进入端口</div><div class="line">[R3-GigabitEthernet0/0/2]dhcp select global //选择为dhcp全局模式 </div><div class="line">[R3-GigabitEthernet0/0/2]quit</div><div class="line">[R3]ip pool 1 //创建地址池1</div><div class="line">[R3-ip-pool-1]network 192.168.1.0 mask 24 //设置ip地址池</div><div class="line">[R3-ip-pool-1]gateway-list 192.168.1.1 //设置网关地址</div><div class="line">[R3-ip-pool-1]dns-list 8.8.8.8 //设置dns</div><div class="line">[R3-ip-pool-1]lease day 3 hour 5 //设置ip地址租期</div><div class="line">[R3]ip pool 2 //创建地址池2</div><div class="line">[R3-ip-pool-2]network 192.168.2.0 mask 24//设置ip地址池</div><div class="line">[R3-ip-pool-2]gateway-list 192.168.2.1 //设置网关地址</div><div class="line">[R3-ip-pool-2]dns-list 8.8.8.8//设置dns</div><div class="line">[R3-ip-pool-2]lease day 3 hour 5 //设置地址租期</div></pre></td></tr></table></figure>
<h2 id="七、VLAN-局域网（Virtual-Local-Area-Netwok）"><a href="#七、VLAN-局域网（Virtual-Local-Area-Netwok）" class="headerlink" title="七、VLAN 局域网（Virtual Local Area Netwok）"></a>七、<a href="https://baike.baidu.com/item/%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91?fromtitle=VLAN&amp;fromid=320429" target="_blank" rel="external">VLAN 局域网</a>（Virtual Local Area Netwok）</h2><h3 id="VLAN基本概念"><a href="#VLAN基本概念" class="headerlink" title="VLAN基本概念"></a>VLAN基本概念</h3><ol>
<li><strong>对逻辑局域网络进行逻辑的划分</strong></li>
<li><strong>为什么要划分VLAN？</strong>   </li>
<li><strong>划分的方式</strong></li>
<li><strong>广播的产生</strong>  对目标的未知就会产生广播 任何一个节点都存在对目标的未知 节点数越多吗，广播流量越大</li>
</ol>
<p>在二层网络当中 广播流量超过总流量的20%-30%，说明网络需要优化 必须进行切割 隔离</p>
<h4 id="网络隔离的方式"><a href="#网络隔离的方式" class="headerlink" title="网络隔离的方式"></a>网络隔离的方式</h4><ol>
<li><strong>物理</strong>  路由器 1.增加设备 增加成本 2.改变了网络的拓扑结构 3.灵活性不够 </li>
<li><strong>逻辑</strong> 交换机(VLAN技术)</li>
</ol>
<h4 id="接口的链路类型"><a href="#接口的链路类型" class="headerlink" title="接口的链路类型"></a>接口的链路类型</h4><ol>
<li><strong>Access</strong>  专用，只承载一个VLAN的数据</li>
<li><strong>Trunk</strong> 公共，可以承载所有VLAN的数据</li>
<li><strong>Hybrid</strong> 混合，xxxx，华为路由器默认链路类型</li>
</ol>
<h4 id="VLAN封装协议"><a href="#VLAN封装协议" class="headerlink" title="VLAN封装协议"></a>VLAN封装协议</h4><p>802.1q (公有)  ISL(Cisco私有)</p>
<h3 id="VLAN基本配置"><a href="#VLAN基本配置" class="headerlink" title="VLAN基本配置"></a>VLAN基本配置</h3><p><img src="https://wx2.sinaimg.cn/mw1024/786be24dgy1fn3o3otca4j20jr0kfabe.jpg" alt="VLAN信息 "></p>
<h4 id="VLAN基本命令"><a href="#VLAN基本命令" class="headerlink" title="VLAN基本命令"></a>VLAN基本命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[LSW1]display vlan //查看vlan信息</div><div class="line">[LSW1]vlan batch 10 20 30 //批量创建vlan10 vlan 20 vlan 30</div><div class="line">LSW1]vlan batch 10 to 20 //批量创建vlan10-vlan20</div><div class="line">[LSW1]vlan10 //创建或者打开vlan10</div><div class="line">[LSW1-vlan10]description 1 //将vlan10命名为1</div><div class="line">[LSW1]display port vlan //查看vlan的链路类型以及PVID</div></pre></td></tr></table></figure>
<h4 id="端口类型转换"><a href="#端口类型转换" class="headerlink" title="端口类型转换"></a>端口类型转换</h4><p><em>需要将端口类型转换成acess才能将端口添加至其他vlan</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[LSW1-GigabitEthernet0/0/1]port link-type access //将端口类型换成acess</div><div class="line">[LSW1-GigabitEthernet0/0/1]port default vlan 10//将端口添加到vlan </div><div class="line">[LSW2-vlan10]port Ethernet 0/0/1/在vlan组里面添加端口 这步命令才能执行</div><div class="line">[LSW2-Ethernet0/0/8]undo portswitch //将交换接口转换成路由接口 （华为大部分S系列交换机不支持）</div></pre></td></tr></table></figure>
<h4 id="定义端口组"><a href="#定义端口组" class="headerlink" title="定义端口组"></a>定义端口组</h4><p><em>实现对端口进行批量操作</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[LSW1]port-group hcie //创建端口组</div><div class="line">[LSW1-port-group-hcie]group-member e 0/0/5 to e 0/0/15 e 0/0/17 g 0/0/1 //添加e5-e15，e17,g1到端口组 </div><div class="line">[LSW1-port-group-hcie]port link-type access//组内端口设置为Acessm模式 </div><div class="line">[LSW1-port-group-hcie]port default vlan 30 //组内端口划分给vlan30</div></pre></td></tr></table></figure>
<h4 id="中继链路的配置"><a href="#中继链路的配置" class="headerlink" title="中继链路的配置"></a>中继链路的配置</h4><p><em>VLAN数据帧是否被交换机所转发的条件</em></p>
<p><em>1. 交换机中要有这个VLAN存在</em></p>
<p><em>2. 交换机收发的VLAN列表中要有这个VLAN的存在</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[LSW1]int Ethernet 0/0/4</div><div class="line">[LSW1-Ethernet0/0/4]port link-type trunk //更改链路类型为Trunk</div><div class="line">[LSW1-Ethernet0/0/4]port trunk allow-pass vlan all //端口允许所有vlan通过</div><div class="line">[LSW1-Ethernet0/0/4]display port vlan active e 0/0/4 //查看端口vlan通过信息</div><div class="line">LSW2的配置相同</div></pre></td></tr></table></figure>
<h3 id="VLAN的四种情况"><a href="#VLAN的四种情况" class="headerlink" title="VLAN的四种情况"></a>VLAN的四种情况</h3><table>
<thead>
<tr>
<th>交换机\VLAN</th>
<th>相同</th>
<th>不同</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>相同</strong></td>
<td>直接通讯</td>
<td>三层设备</td>
</tr>
<tr>
<td><strong>不同</strong></td>
<td>中继链路</td>
<td>三层设备</td>
</tr>
</tbody>
</table>
<p><strong>相同交换机 相同VLAN</strong>   直接通讯</p>
<p><strong>相同交换机 不同VLAN</strong> 三层设备通讯(路由)</p>
<p><strong>不同交换机 相同VLAN</strong> 中继链路</p>
<p><strong>不同交换机 不同VLAN</strong> 三层路由（路由）</p>
<p>数据传递过程当中，VLAN必须保证不变化，中间人如果更改，会导致数据包不可达</p>
<h3 id="两个节点通讯的前提条件"><a href="#两个节点通讯的前提条件" class="headerlink" title="两个节点通讯的前提条件"></a>两个节点通讯的前提条件</h3><ol>
<li><p>在同一个网路</p>
</li>
<li><p>在同一个网段</p>
<p>​</p>
</li>
</ol>
<p><img src="https://wx4.sinaimg.cn/mw1024/786be24dgy1fn3o3opl6wj20gu03bdfr.jpg" alt="VLAN网关表"></p>
<p>按照上图配置VLAN接口的ip地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[LSW1]interface vlan 10 进入vlan10接口</div><div class="line">[LSW1-Vlanif10]ip ad 192.168.10.1 24 //配置ip</div><div class="line">[LSW1-Vlanif10]dis ip interface brief //</div></pre></td></tr></table></figure>
<p>​                     </p>
<p>​                                      <em>上述配置完成后的三层交换路由表</em></p>
<p><img src="https://wx1.sinaimg.cn/mw1024/786be24dgy1fn3o3pq6jlj20hi078jrj.jpg" alt="三层交换路由表"></p>
<h2 id="八、ACL访问控制列表"><a href="#八、ACL访问控制列表" class="headerlink" title="八、ACL访问控制列表"></a>八、<a href="https://baike.baidu.com/item/ACL/362453?fr=aladdin" target="_blank" rel="external">ACL访问控制列表</a></h2><h4 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h4><p> 允许 或 拒绝 数据包通过</p>
<p><strong>单独使用</strong>  包过滤功能</p>
<p><strong>结合使用</strong> 作为工具被其他技术调用（VPN NAT 策略路由 路由策略…….）(更多)</p>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">基本</th>
<th style="text-align:center">高级</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>过滤包</strong></td>
<td style="text-align:center">源ip</td>
<td style="text-align:center">源ip、目标ip、源端口、目标端口、协议、选项等</td>
</tr>
<tr>
<td style="text-align:center"><strong>优点</strong></td>
<td style="text-align:center">效率高（首选）</td>
<td style="text-align:center">功能全</td>
</tr>
<tr>
<td style="text-align:center"><strong>取值范围</strong></td>
<td style="text-align:center">2000-2999</td>
<td style="text-align:center">3000-3999</td>
</tr>
</tbody>
</table>
<h4 id="基本ACL语法"><a href="#基本ACL语法" class="headerlink" title="基本ACL语法"></a>基本ACL语法</h4><p>rule [ rule-id ] { deny | permit } [ rule-string ]</p>
<p>rule-id：ACL规则编号，取值范围为0～65534</p>
<p>deny：表示丢弃符合条件的数据包</p>
<p>permit：表示允许符合条件的数据包通过</p>
<h4 id="高级ACL语法"><a href="#高级ACL语法" class="headerlink" title="高级ACL语法"></a>高级ACL语法</h4><p>rule [ rule-id ] { deny | permit } protocol [ rule-string ]</p>
<p>rule-id：ACL规则编号，取值范围为0～65534</p>
<p>deny：表示丢弃符合条件的数据包</p>
<p>permit：表示允许符合条件的数据包通过。</p>
<p>protocol：IP承载的协议类型。用数字表示时，取值范围为1～255；用名字表示时，可以选取</p>
<p>gre（47）、icmp（1）、igmp（2）、ip、ipinip（4）、ospf（89）、tcp（6）、udp（17）</p>
<h4 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h4><ol>
<li>按序检查</li>
<li>匹配停止</li>
<li>默认允许（Cisco默认拒绝）</li>
</ol>
<h4 id="访问列表的配置步骤"><a href="#访问列表的配置步骤" class="headerlink" title="访问列表的配置步骤"></a>访问列表的配置步骤</h4><ol>
<li>系统模式全局定义</li>
<li>接口模式引用</li>
</ol>
<p><strong>需要确定的三个问题</strong></p>
<ol>
<li>哪个路由器？</li>
<li>哪个接口？</li>
<li>哪个方向?</li>
</ol>
<p><em>答案是都可以，但是需要考虑一些因素</em> </p>
<ol>
<li>数据是否经过</li>
<li>是否有权限对设备进行配置</li>
<li>合理性 寻找最优规则</li>
</ol>
<p><img src="https://wx1.sinaimg.cn/mw1024/786be24dly1fn4f7e8lkoj20p60b4wfd.jpg" alt="ACL样例"></p>
<p>​                                                                                        ACL访问控制列表实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[AR1]ACL 3000 //设置3000的高级访问控制列表</div><div class="line">[AR1-acl-adv-3000]rule deny ICMP source 192.168.1.0 0.0.0.255//网段</div><div class="line">[AR1-acl-adv-3000]rule deny ICMP source 192.168.1.2 0.0.0.0 //只有这个地址</div><div class="line">[AR1-acl-adv-3000]rule deny ICMP source 192.168.1.2 0.0.0.255 destination 192.168.5.2 0.0.0.0 icmp-type echo  //拒绝ping的回复包</div><div class="line">[AR1-acl-adv-3000]rule deny tcp source 192.168.1.2 0 destination 192.168.5.2 0 destination-port eq 80 //拒绝80端口TCP连接 HTTP协议</div><div class="line">[AR1-acl-adv-3000]rule deny IP source 192.168.1.2 0.0.0.255 destination 192.168.3.2 0 //拒绝来自的192.168.3.2的数据包</div><div class="line">[AR1-GigabitEthernet0/0/0]traffic-filter inbound acl 3000 //端口GigabitEthernet0/0/0启用ACL规则</div></pre></td></tr></table></figure>
<h2 id="九、GVRP-通用VLAN注册协议"><a href="#九、GVRP-通用VLAN注册协议" class="headerlink" title="九、GVRP 通用VLAN注册协议"></a>九、GVRP 通用VLAN注册协议</h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p>动态学习VLAN</p>
<p>必须使用Trunk链路</p>
<p>全局GVRP</p>
<p>接口GVRP</p>
<p>参与的接口都要启用GVRP</p>
<p>中间过渡交换机</p>
<p>边缘介入交换机</p>
<p><img src="https://wx3.sinaimg.cn/mw1024/786be24dly1fn4l6w33e3j20j9044t8r.jpg" alt="GVRP"></p>
<figure class="highlight plain"><figcaption><span>port link-type trunk</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[LSW1]GVRP //全局配置GVRP</div><div class="line">[LSW1]int GigabitEthernet 0/0/1</div><div class="line">[LSW1-GigabitEthernet0/0/1] port link-type trunk</div><div class="line">[LSW1-GigabitEthernet0/0/1]port trunk allow-pass vlan all </div><div class="line">[LSW1-GigabitEthernet0/0/1]GVRP</div></pre></td></tr></table></figure>
<p>VLAN类型的不同，对于各技术的支持程序是不一样的 有些VLAN不支持有些技术</p>
<h2 id="十、链路聚合"><a href="#十、链路聚合" class="headerlink" title="十、链路聚合"></a>十、链路聚合</h2><p>将多条物理的链路捆绑成为一条逻辑的链路</p>
<p>提高带宽，负载均衡，冗余备份</p>
<p>参与链路聚合的端口所有参数必须保持一致性</p>
<p>二层聚合、三层聚合</p>
<p>二层链路聚合，一般都建议将聚合后的链路配置为Trunk</p>
<p>链路聚合后，对端口的配置，是配置Eth-Trunk逻辑接口而不是物理接口</p>
<p>链路聚合的配置</p>
<h3 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h3><ol>
<li><strong>手动</strong> ，默认，只能做负载均衡</li>
<li><strong>LACP静态</strong> <ul>
<li>LACP：链路聚合控制协议</li>
</ul>
</li>
</ol>
<p><img src="https://wx3.sinaimg.cn/mw1024/786be24dly1fn4l6wf7hhj20ga058748.jpg" alt="链路聚合"></p>
<h3 id="链路聚合基本配置"><a href="#链路聚合基本配置" class="headerlink" title="链路聚合基本配置"></a>链路聚合基本配置</h3><h4 id="交换机的链路聚合配置"><a href="#交换机的链路聚合配置" class="headerlink" title="交换机的链路聚合配置"></a>交换机的链路聚合配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[Huawei]interface Eth-Trunk 1  //创建Eth-Thrunk1逻辑接口， 0-63的取值范围</div><div class="line">[Huawei-Eth-Trunk1]trunkport e 0/0/1 to 0/0/3 //将0-3配置成聚合</div><div class="line">LSW2执行相同配置</div><div class="line">更改模式为lacp-static  Trunk模式不行</div><div class="line">[Huawei-Eth-Trunk1]mode lacp-static </div><div class="line">[Huawei-Eth-Trunk1]max Active-linknumber 2 设置最大活动链接数</div></pre></td></tr></table></figure>
<p><img src="https://wx1.sinaimg.cn/mw1024/786be24dly1fn4l6w5o95j20f704o3yh.jpg" alt="路由器链路聚合"></p>
<h4 id="路由器链路聚合的配置"><a href="#路由器链路聚合的配置" class="headerlink" title="路由器链路聚合的配置"></a>路由器链路聚合的配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[R1]int e 1 //创建逻辑端口1</div><div class="line">[R1-Eth-Trunk1]trunkport g 0/0/0 to 0/0/1 // 添加G0/0/0 和G0/0/1到逻辑端口1</div><div class="line">[R1-Eth-Trunk1]ip ad 192.168.1.1 24 //添加逻辑接口1的IP</div><div class="line">R2前面配置相同，ip配置不同</div><div class="line">[R2-Eth-Trunk1]ip ad 192.168.1.2 24 //给R2上的逻辑端口设置IP地址</div></pre></td></tr></table></figure>
<h2 id="十一、STP，生成树"><a href="#十一、STP，生成树" class="headerlink" title="十一、STP，生成树"></a>十一、STP，生成树</h2><p><strong>环路</strong> ：不可避免，或多或少都会产生  <strong>原因</strong> ：人为、协议缺陷</p>
<p><strong>二层</strong> ，STP </p>
<p><strong>三层</strong> ，TTL 消除环路但是不能避免环路</p>
<h3 id="STP的作用"><a href="#STP的作用" class="headerlink" title="STP的作用"></a>STP的作用</h3><ol>
<li>防止环路  </li>
<li>数据流控</li>
</ol>
<h4 id="树形结构的特点"><a href="#树形结构的特点" class="headerlink" title="树形结构的特点"></a>树形结构的特点</h4><ol>
<li>连续性</li>
<li>唯一性  </li>
</ol>
<h4 id="根网桥、根端口、指定端口"><a href="#根网桥、根端口、指定端口" class="headerlink" title="根网桥、根端口、指定端口"></a>根网桥、根端口、指定端口</h4><table>
<thead>
<tr>
<th style="text-align:center">根网桥</th>
<th style="text-align:center">根端口</th>
<th style="text-align:center">指定端口</th>
<th style="text-align:center">阻塞端口</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">所有端口都是指定端口（理论）</td>
<td style="text-align:center">级联向上</td>
<td style="text-align:center">级联向下</td>
<td style="text-align:center">其他端口</td>
</tr>
</tbody>
</table>
<p><img src="https://wx4.sinaimg.cn/mw1024/786be24dly1fn4nv6h9zej20rw0k8796.jpg" alt="根端口指定端口的区别"></p>
<p>Tips：生成树的最终目的是为了选举阻塞端口* </p>
<h3 id="选举依据"><a href="#选举依据" class="headerlink" title="选举依据"></a>选举依据</h3><ol>
<li>根路径成本</li>
<li>网桥ID</li>
<li>端口ID</li>
</ol>
<p><img src="https://wxt.sinaimg.cn/mw1024/786be24dly1fn4nsewo5gj20kr0fbq70.jpg?tags=%5B%5D" alt="STP选举实例"></p>
<p><strong>注意</strong>  <em>Tips:STP使用桥协数据单元BPDU帧计算根,传输选举依据</em></p>
<h3 id="生成树端口的状态"><a href="#生成树端口的状态" class="headerlink" title="生成树端口的状态"></a>生成树端口的状态</h3><h4 id="交换机端口的5种STP状态"><a href="#交换机端口的5种STP状态" class="headerlink" title="交换机端口的5种STP状态"></a>交换机端口的5种STP状态</h4><p><strong>转发</strong>   转发数据包 收发BPDU 学习MAC地址</p>
<p><strong>学习</strong>   收发 BPDU 处理BPDU 学习MAC地址</p>
<p><strong>侦听</strong>   接收、处理、转发BPDU</p>
<p><strong>阻塞</strong>  接收并处理BPDU  但是不转发</p>
<p><strong>禁用</strong>  什么都没有</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">接收BPDU</th>
<th style="text-align:center">处理BPDU</th>
<th style="text-align:center">转发BPDU</th>
<th style="text-align:center">学习MAC</th>
<th style="text-align:center">收发数据帧</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>转发</strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center"><strong>学习</strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center"><strong>侦听</strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center"><strong>阻塞</strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center"><strong>禁用</strong></td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
</tbody>
</table>
<h3 id="STP的三种计时器"><a href="#STP的三种计时器" class="headerlink" title="STP的三种计时器"></a>STP的三种计时器</h3><ol>
<li>HELLO 2</li>
<li>转发延迟 15s</li>
<li>最大老化时间 20S</li>
</ol>
<p><em>Tips：因为端口转换的时间过长，不能快速收敛</em> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;Huawei&gt;display stp brief </div><div class="line">[Huawei]stp priority 0  //可以设置 4096 8192.... 倍数</div></pre></td></tr></table></figure>
<h3 id="使用MSTP（多生成树）完成常见组网需求配置"><a href="#使用MSTP（多生成树）完成常见组网需求配置" class="headerlink" title="使用MSTP（多生成树）完成常见组网需求配置"></a>使用MSTP（多生成树）完成常见组网需求配置</h3><p><img src="https://wx3.sinaimg.cn/mw1024/786be24dly1fn5hv5osn6j20ef0c2jrw.jpg" alt="常见组网需求"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">1、链路聚合</div><div class="line">[LSW1]int e 1</div><div class="line">[LSW1-Eth-Trunk1]trunkport g 0/0/1</div><div class="line">[LSW1-Eth-Trunk1]trunkport g 0/0/2</div><div class="line">LSW2执行相同操作</div><div class="line">2、创建VLAN</div><div class="line">[LSW1]vlan b 10 20 30 40</div><div class="line">LSW2 LSW3 LSW4 执行相同操作</div><div class="line">3、中继链路</div><div class="line">[LSW4]int e 1</div><div class="line">[LSW4-Eth-Trunk1]port link-type trunk </div><div class="line">[LSW4-Eth-Trunk1]port trunk allow-pass vlan all</div><div class="line">4、MSTP配置 </div><div class="line">[LSW1]stp region-configuration </div><div class="line">[LSW1-mst-region]region-name hcie //创建区域HCIE</div><div class="line">[LSW1-mst-region]instance 1 vlan 10 20</div><div class="line">[LSW1-mst-region]instance 2 vlan 30 40</div><div class="line">[LSW1-mst-region]revision-level ?//级别</div><div class="line">[LSW1-mst-region]active region-configuration //区域配置</div><div class="line">LSW2 LSW3 LSW4  执行相同配置</div><div class="line">[LSW1]stp instance 1 priority 0或者[LSW1]stp instance 1 root primary </div><div class="line">[LSW1]stp instance 2 root secondary </div><div class="line">LSW2交换顺序 1为备 2为主</div></pre></td></tr></table></figure>
<p>​                                                            <strong>上述配置完成后LSW3的配置</strong> </p>
<p><img src="https://wx4.sinaimg.cn/mw1024/786be24dly1fn5hv5o80cj20ex03paa1.jpg" alt="STP端口状态"></p>
<p>Tips：交换机端口的角色与状态与实例的多少成正比，一个端口在不同的实例中会有不同的角色与状态*</p>
<p><em>Tips：默认情况所有VLAN属于生成树实例0</em> </p>
<h2 id="十二、-GRE隧道配置"><a href="#十二、-GRE隧道配置" class="headerlink" title="十二、 GRE隧道配置"></a>十二、 <em>GRE</em>隧道配置</h2><p><img src="https://wx3.sinaimg.cn/mw1024/786be24dly1fn5njvqmugj20lw07tt94.jpg" alt="GRE隧道配置"></p>
<p>按照上图配置，要实现全网互通，可以使用路由引入。也可以如下设置GRE隧道。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[R2]int Tunnel 0/0/0 //创建并进入一个逻辑隧道接口</div><div class="line">[R2-Tunnel0/0/0]ip address 123.123.123.1 24 //给逻辑隧道接口一个IP地址，实现与对端隧道接口的通讯</div><div class="line">[R2-Tunnel0/0/0]tunnel-protocol gre 选择逻辑接口协议为GRE</div><div class="line">[R2-Tunnel0/0/0]source 192.168.2.1 //源端端口</div><div class="line">[R2-Tunnel0/0/0]destination 192.168.3.2 //目的端端口</div><div class="line">[R2-rip-1]net 123.0.0.0 //添加rip规则</div><div class="line">[R1-rip-1]version 2 更改RIP版本为版本2</div><div class="line">[R1-rip-1]summary always 更改为汇总（默认是开启的）</div><div class="line">[R1]int loo 1</div><div class="line">[R1-LoopBack1]ip ad 10.10.10.1 32</div><div class="line">[R1-LoopBack1]ip ad 10.10.10.2 32 sub</div><div class="line">[R1-LoopBack1]ip ad 10.10.10.3 32 sub  //给回环端口添加3个ip地址</div><div class="line">[R1]rip</div><div class="line">[R1-rip-1]net 10.0.0.0//添加rip规则</div><div class="line">[R1]acl 2000</div><div class="line">[R1-acl-basic-2000]rule deny source 10.10.10.2 0 //创建基本ACL规则 拒绝所有来自10.10.10.2的包</div><div class="line">[R1-rip-1]filter-policy 2000 import g0/0/0 //不允许入</div><div class="line">[R1-rip-1]filter-policy 2000 export g0/0/0 //不允许出</div><div class="line">[R1-acl-basic-2000]rule permit//允许通过所有协议</div></pre></td></tr></table></figure>
<p>​                                                            <strong>GRE配置成功后R5的路由表</strong> </p>
<p><img src="https://wx1.sinaimg.cn/mw1024/786be24dly1fn5nxx66uhj20i8099glv.jpg" alt="GRE配置成功后的路由表"></p>
<p>Tips:在rip里面，network只能按照有类宣告ip地址*</p>
<p><em>Tips:RIP的汇总默认是开启的，如果有水平分割，毒性逆转，则不开启</em> </p>
<h2 id="十三、NAT网络地址转换"><a href="#十三、NAT网络地址转换" class="headerlink" title="十三、NAT网络地址转换"></a>十三、NAT网络地址转换</h2><p>​                 实现私有IP地址与公有IP地址之间的互换</p>
<h3 id="IP地址"><a href="#IP地址" class="headerlink" title="IP地址"></a>IP地址</h3><ol>
<li><strong>有类</strong>  A B C D E类</li>
<li><p><strong>无类 </strong> ………</p>
<p><strong>公有</strong><br><strong>私有</strong>   用于局域网，不能在公共网上路由</p>
</li>
</ol>
<h3 id="转换类型"><a href="#转换类型" class="headerlink" title="转换类型"></a>转换类型</h3><p><strong>静态</strong> 一个公有IP对一个私有IP转换,没有节省到IP</p>
<ul>
<li>一对一，没有节省IP地址网络</li>
<li>通讯内外都可以触发</li>
</ul>
<p><strong>动态</strong>   少数公有IP对于数据私有IP</p>
<ul>
<li>会引入地址池</li>
<li>地址池需要配置定义</li>
<li>轮训调用机制</li>
<li>需要注意，地址池的公网IP能否满足 私有IP的转换要求</li>
</ul>
<p><strong>PAT</strong> 用一个接口的公有IP对应所有IP</p>
<h3 id="EasyIP的配置"><a href="#EasyIP的配置" class="headerlink" title="EasyIP的配置"></a>EasyIP的配置</h3><p><img src="https://wx2.sinaimg.cn/mw1024/786be24dly1fn5rnqwagej20hw0aawf4.jpg" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">按照上图进行地址配置</div><div class="line">[AR1]acl 2000</div><div class="line">[AR1-acl-basic-2000]rule permit source 192.168.1.2 0</div><div class="line">[AR1-acl-basic-2000]rule permit source 192.168.1.3 0</div><div class="line">[AR1-acl-basic-2000]int g 0/0/0</div><div class="line">[AR1-GigabitEthernet0/0/0]nat outbound 2000</div></pre></td></tr></table></figure>
<p>​                                                                           <strong>以下是实际工作环境实例</strong> </p>
<p><img src="https://wx4.sinaimg.cn/mw1024/786be24dgy1fn5wyoiuf1j20rg09vmy5.jpg" alt="img"></p>
<h2 id="十四、防火墙"><a href="#十四、防火墙" class="headerlink" title="十四、防火墙"></a>十四、防火墙</h2><h3 id="防火墙分类"><a href="#防火墙分类" class="headerlink" title="防火墙分类"></a>防火墙分类</h3><ol>
<li>包过滤、代理、状态检测(精确匹配，能处理应用层)</li>
<li>主机、网络</li>
<li>硬件、软件</li>
</ol>
<h3 id="防火墙与路由器的区别"><a href="#防火墙与路由器的区别" class="headerlink" title="防火墙与路由器的区别"></a>防火墙与路由器的区别</h3><table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">原理</th>
<th style="text-align:center">侧重</th>
<th style="text-align:center">工作层级</th>
<th style="text-align:center">其他</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>防火墙</strong></td>
<td style="text-align:center">基于区域</td>
<td style="text-align:center">重在数据控制</td>
<td style="text-align:center">网络层、链路层</td>
<td style="text-align:center">…..</td>
</tr>
<tr>
<td style="text-align:center"><strong>路由器</strong></td>
<td style="text-align:center">基于接口转发数据</td>
<td style="text-align:center">重在转发</td>
<td style="text-align:center">网络层</td>
<td style="text-align:center">…</td>
</tr>
</tbody>
</table>
<h3 id="区域与接口的关系"><a href="#区域与接口的关系" class="headerlink" title="区域与接口的关系"></a>区域与接口的关系</h3><ol>
<li>接口必须加入到区域才能够使用</li>
<li>一个区域可以有多个接口</li>
<li>一个接口只能属于一个区域</li>
</ol>
<h3 id="区域"><a href="#区域" class="headerlink" title="区域"></a>区域</h3><ol>
<li><strong>Local</strong>  本地（防火墙自己） <em>优先级100</em> <ul>
<li>防火墙的所有接口都属于这个区域</li>
</ul>
</li>
<li><strong>Trust</strong>  信任（内外，工作区）<em>优先级 85</em> </li>
<li><strong>Untrust</strong>  非信任（外网） <em>优先级5</em> </li>
<li><strong>DMZ</strong>  非军事化区域（内网，服务器区） <em>优先级50</em> </li>
<li><strong>Vzone</strong>  虚拟区域 <em>优先级 0</em> </li>
</ol>
<h3 id="安全级别（优先级）"><a href="#安全级别（优先级）" class="headerlink" title="安全级别（优先级）"></a>安全级别（优先级）</h3><p>取值范围（0-100）</p>
<p>数值越小，越不安全</p>
<p><strong>唯一性</strong> 不能冲突，两个区域不能有相同的优先级</p>
<h3 id="方向"><a href="#方向" class="headerlink" title="方向"></a>方向</h3><p><strong>入</strong> 低安全级别的区域 到 高安全级别的区域</p>
<p>​    eg. Utrust  5   &gt;&gt;&gt; Trust  85</p>
<p><strong>出</strong>  高安全级别的区域 到 低安全级别的区域</p>
<p>​         eg.Utrust  5   &gt;&gt;&gt; Trust  85</p>
<h3 id="策略及规则（防火墙进行数据转发的规则）"><a href="#策略及规则（防火墙进行数据转发的规则）" class="headerlink" title="策略及规则（防火墙进行数据转发的规则）"></a>策略及规则（防火墙进行数据转发的规则）</h3><p>默认策略</p>
<p>自定义策略（优先）</p>
<p>在默认情况下：</p>
<ol>
<li>防火墙不允许数据穿越</li>
<li>防火墙可以发出数据，但是不允许数据进入</li>
<li>区域内可以相互通讯</li>
<li>防火墙（Local）可以和Trust区域通讯</li>
</ol>
<h3 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[SRG]firewall zone name hcie</div><div class="line">[SRG-zone-hcie]set priority 10</div><div class="line">[SRG-zone-hcie]display zone</div><div class="line">[SRG-zone-hcie]add interface g0/0/5</div><div class="line">&lt;SRG&gt;display firewall packet-filter default interzone local dmz  //到dma默认区域的传送规则</div><div class="line">&lt;SRG&gt;display firewall packet-filter default interzone local trust//要到trust默认区域传送的规则</div><div class="line">&lt;SRG&gt;display firewall packet-filter default interzone trust untrust  //要转发的数据默认区域传送的规则</div></pre></td></tr></table></figure>
<h3 id="防火墙基础案例"><a href="#防火墙基础案例" class="headerlink" title="防火墙基础案例"></a>防火墙基础案例</h3><p><img src="https://wx1.sinaimg.cn/mw1024/786be24dgy1fn5wyoj3ukj20bh07baa6.jpg" alt="防火墙基本配置"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[SRG]int g 0/0/1</div><div class="line">[SRG-GigabitEthernet0/0/1]ip ad 192.168.1.1 24</div><div class="line">[SRG]int g 0/0/2</div><div class="line">[SRG-GigabitEthernet0/0/2]ip ad 192.168.2.1 24</div><div class="line">[SRG]firewall zone  trust</div><div class="line">[SRG-zone-trust]add int g 0/0/2</div><div class="line">[SRG]firewall zone  untrust</div><div class="line">[SRG-zone-trust]add int g 0/0/1</div><div class="line">[SRG]firewall packet-filter default permit interzone untrust trust</div><div class="line">[SRG]firewall packet-filter default permit interzone untrust trust direction inb</div><div class="line">ound  //允许untrust进入trust</div><div class="line">[SRG]firewall packet-filter default permit interzone untrust trust direction out</div><div class="line">bound //允许untrust出trust</div></pre></td></tr></table></figure>
<h3 id="自定义策略"><a href="#自定义策略" class="headerlink" title="自定义策略"></a>自定义策略</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[SRG]policy interzone untrust trust outbound </div><div class="line">[SRG-policy-interzone-trust-untrust-outbound-0]policy 1</div><div class="line">[SRG-policy-interzone-trust-untrust-outbound-1]policy source 192.168.2.1  0</div><div class="line">[SRG-policy-interzone-trust-untrust-outbound-1]action deny</div></pre></td></tr></table></figure>
<h2 id="十五、Mux-VLAN"><a href="#十五、Mux-VLAN" class="headerlink" title="十五、Mux VLAN"></a>十五、Mux VLAN</h2><h3 id="基本概念-2"><a href="#基本概念-2" class="headerlink" title="基本概念"></a>基本概念</h3><p>Mux Vkan提供了一种在Vlan的端口间进行二层流量隔离的机制</p>
<ol>
<li><p>主VLAN</p>
</li>
<li><p>从VLAN</p>
<p>​隔离型从VLAN</p>
<p>​互通型从VLAN</p>
</li>
</ol>
<p><strong>4种通信方式</strong> </p>
<ol>
<li>从VLAN可以主VLAN通信</li>
<li>从VLAN之间不能通信</li>
<li>隔离型从VLAN内部不能通信</li>
<li>互通型从VLAN内部可以互通</li>
</ol>
<h3 id="Mux-VLAN的配置"><a href="#Mux-VLAN的配置" class="headerlink" title="Mux VLAN的配置"></a>Mux VLAN的配置</h3><p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn908iia1vj20j30b6t9p.jpg" alt="Max VLAN"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">[Huawei]vlan b 10 20 100</div><div class="line">[Huawei]interface Ethernet0/0/1</div><div class="line">[Huawei-Ethernet0/0/1]port link-type access</div><div class="line">[Huawei-Ethernet0/0/1]port default vlan 10</div><div class="line">[Huawei-Ethernet0/0/1]port mux-vlan enable</div><div class="line">[Huawei-Ethernet0/0/1]int e 0/0/2</div><div class="line">[Huawei-Ethernet0/0/2]port default vlan 10</div><div class="line">[Huawei-Ethernet0/0/2]port mux-vlan enable</div><div class="line">dis  vlan</div><div class="line">其余配置   E 0/0/3 和E 0/0/4配 VLAN 20 + port mux-vlan enable</div><div class="line">[Huawei-Ethernet0/0/5]vl 100</div><div class="line">[Huawei-vlan100]mux-vlan </div><div class="line">[Huawei-vlan100]subordinate separate 20</div><div class="line">[Huawei-vlan100]subordinate group 10</div></pre></td></tr></table></figure>
<h2 id="十六、端口隔离"><a href="#十六、端口隔离" class="headerlink" title="十六、端口隔离"></a>十六、端口隔离</h2><p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn904iacdqj20h808qwf0.jpg" alt="端口隔离"></p>
<p>配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[Huawei]int e 0/0/1</div><div class="line">[Huawei-Ethernet0/0/1]port-isolate enable</div><div class="line">[Huawei]int e 0/0/2</div><div class="line">[Huawei-Ethernet0/0/2]port-isolate enable</div></pre></td></tr></table></figure>
<h2 id="十七、ARP代理"><a href="#十七、ARP代理" class="headerlink" title="十七、ARP代理"></a>十七、ARP代理</h2><p><strong>ARP</strong> 将一个已知的IP地址解析成为一个MAC地址</p>
<p><strong>链路层</strong> </p>
<p>LLC 逻辑链路控制</p>
<p>MAC 媒体访问控制</p>
<ol>
<li>VLAN内</li>
<li>VAN间</li>
<li>路由式</li>
</ol>
<h3 id="ARP代理的配置"><a href="#ARP代理的配置" class="headerlink" title="ARP代理的配置"></a>ARP代理的配置</h3><p>启用ARP代理功能之后，会出现一个MAC地址对应多个IP的情况，正常情况下是一个IP对应一个MAC</p>
<p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn904iacdqj20h808qwf0.jpg" alt="端口隔离"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[Huawei]int vl 1</div><div class="line">[Huawei-Vlanif1]ip ad 192.168.1.1 24  </div><div class="line">[Huawei-Vlanif1]arp-proxy inner-sub-vlan-proxy enable ##允许区域内arp代理</div></pre></td></tr></table></figure>
<p>配置完成后PC1的ARP信息</p>
<p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn90njb598j20cg02pdfp.jpg" alt="APR"></p>
<h3 id="Super-VLAN的应用和配置"><a href="#Super-VLAN的应用和配置" class="headerlink" title="Super VLAN的应用和配置"></a>Super VLAN的应用和配置</h3><ol>
<li>VLAN多、交换机多、网段多</li>
<li>IP地址规划变得复杂</li>
</ol>
<p>有没有一种方案，可以实现不同VLAN，但是相同网段？</p>
<p>所有VLAN都是属于一个网段</p>
<p>使用VLAN间的ARP代理功能来实现不同VLAN相同网段的通信</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">前面的配置 创建VLAN 10 20 30 100 </div><div class="line">将0/0/1 0/0/2 0/0/3 分别加入VLAN 10 20 30 </div><div class="line">进入VLAN 100</div><div class="line">[Huawei-vlan100]aggregate-vlan</div><div class="line">[Huawei-Vlanif100]ip add 192.168.1.1 24</div><div class="line">[Huawei-Vlanif100]arp-proxy inter-sub-vlan-proxy <span class="built_in">enable</span> <span class="comment">##允许区域间arp代理</span></div></pre></td></tr></table></figure>
<h2 id="十八、路由器ARP代理"><a href="#十八、路由器ARP代理" class="headerlink" title="十八、路由器ARP代理"></a>十八、路由器ARP代理</h2><p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn987bfd6kj20j5068q39.jpg" alt="路由器ARP代理"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">按照上图配置ip</div><div class="line">[Huawei]int g 0/0/1</div><div class="line">[Huawei-GigabitEthernet0/0/1]arp-proxy <span class="built_in">enable</span> <span class="comment">##允许arp代理</span></div><div class="line">R2 int g 0/0/1 配置一样</div></pre></td></tr></table></figure>
<h2 id="十九、策略路由"><a href="#十九、策略路由" class="headerlink" title="十九、策略路由"></a>十九、策略路由</h2><p><strong>策略路由</strong> 数据转发不依赖于路由表 根据策略实现数据转发 仅作用于本地·<img src="https://ws1.sinaimg.cn/large/786be24dgy1fn9bw7wi8wj20r506ljs3.jpg" alt="策略路由的配置"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">按照上图配置ip地址</div><div class="line">然后配置R1-R5  配置 OSPF</div><div class="line">[R1]acl 2001</div><div class="line">[R1-acl-basic-2001]rule permit <span class="built_in">source</span> 10.10.10.10 0</div><div class="line">[R1]acl 2002</div><div class="line">[R1-acl-basic-2002]rule permit <span class="built_in">source</span> 10.10.10.20 0</div><div class="line">[R1]policy-based-route <span class="built_in">test</span> permit node 1 <span class="comment">##BFD1  1号规则</span></div><div class="line">[R1-policy-based-route-test-1]<span class="keyword">if</span>-match acl 2001</div><div class="line">[R1-policy-based-route-test-1]apply ip-address next-hop 192.168.1.2</div><div class="line">[R1]policy-based-route <span class="built_in">test</span> permit node 2 <span class="comment">##BFD1 2号规则</span></div><div class="line">[R1-policy-based-route-test-2]<span class="keyword">if</span>-match acl 2002</div><div class="line">[R1-policy-based-route-test-2]apply ip-address next-hop 192.168.2.2</div><div class="line">[R1]ip <span class="built_in">local</span> policy-based-route <span class="built_in">test</span></div></pre></td></tr></table></figure>
<p>配置完成后的tracert结果</p>
<p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn9c6qvht2j20jb0cf74t.jpg" alt="tracert"></p>
<h2 id="二十、BFD的配置"><a href="#二十、BFD的配置" class="headerlink" title="二十、BFD的配置"></a>二十、BFD的配置</h2><p>双向转达检测</p>
<p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn9cazvvzmj20fs07kaao.jpg" alt="BFD"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">按照上图配置IP地址</div><div class="line">在路由器R1配置两条静态路由 其中上面的优先级设置为50</div><div class="line">[R1]ip route-static 10.10.10.10 255.255.255.255 192.168.1.2 preference 50</div><div class="line">[R1]ip route-static 10.10.10.10 255.255.255.255 192.168.2.2</div><div class="line">[R1]bfd</div><div class="line">[R1-bfd]bfd 1 bind peer-ip 192.168.1.2 source-ip 192.168.1.1 auto</div><div class="line">[R1-bfd-session-1]commit</div><div class="line">[R1]ip route-static 10.10.10.10 255.255.255.255 192.168.1.2 preference 50 track bfd-session 1</div><div class="line">在R2配置</div><div class="line">[R2]bfd</div><div class="line">[R2-bfd]bfd 1 bind peer-ip 192.168.1.1 source-ip 192.168.1.2 auto</div><div class="line">[R2-bfd-session-1]commit</div><div class="line">在路由器R1配置下面一半的BFD-session 2</div></pre></td></tr></table></figure>
<h2 id="十九、策略路由-1"><a href="#十九、策略路由-1" class="headerlink" title="十九、策略路由"></a>十九、策略路由</h2><p><strong>策略路由</strong> 数据转发不依赖于路由表 根据策略实现数据转发 仅作用于本地·<img src="https://ws1.sinaimg.cn/large/786be24dgy1fn9bw7wi8wj20r506ljs3.jpg" alt="策略路由的配置"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">按照上图配置ip地址</div><div class="line">然后配置R1-R5  配置 OSPF</div><div class="line">[R1]acl 2001</div><div class="line">[R1-acl-basic-2001]rule permit <span class="built_in">source</span> 10.10.10.10 0</div><div class="line">[R1]acl 2002</div><div class="line">[R1-acl-basic-2002]rule permit <span class="built_in">source</span> 10.10.10.20 0</div><div class="line">[R1]policy-based-route <span class="built_in">test</span> permit node 1 <span class="comment">##BFD1  1号规则</span></div><div class="line">[R1-policy-based-route-test-1]<span class="keyword">if</span>-match acl 2001</div><div class="line">[R1-policy-based-route-test-1]apply ip-address next-hop 192.168.1.2</div><div class="line">[R1]policy-based-route <span class="built_in">test</span> permit node 2 <span class="comment">##BFD1 2号规则</span></div><div class="line">[R1-policy-based-route-test-2]<span class="keyword">if</span>-match acl 2002</div><div class="line">[R1-policy-based-route-test-2]apply ip-address next-hop 192.168.2.2</div><div class="line">[R1]ip <span class="built_in">local</span> policy-based-route <span class="built_in">test</span></div></pre></td></tr></table></figure>
<p>配置完成后的tracert结果</p>
<p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn9c6qvht2j20jb0cf74t.jpg" alt="tracert"></p>
<h2 id="二十、BFD的配置-1"><a href="#二十、BFD的配置-1" class="headerlink" title="二十、BFD的配置"></a>二十、BFD的配置</h2><p>双向转达检测</p>
<p><img src="https://ws1.sinaimg.cn/large/786be24dgy1fn9cazvvzmj20fs07kaao.jpg" alt="BFD"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">按照上图配置IP地址</div><div class="line">在路由器R1配置两条静态路由 其中上面的优先级设置为50</div><div class="line">[R1]ip route-static 10.10.10.10 255.255.255.255 192.168.1.2 preference 50</div><div class="line">[R1]ip route-static 10.10.10.10 255.255.255.255 192.168.2.2</div><div class="line">[R1]bfd</div><div class="line">[R1-bfd]bfd 1 bind peer-ip 192.168.1.2 source-ip 192.168.1.1 auto</div><div class="line">[R1-bfd-session-1]commit</div><div class="line">[R1]ip route-static 10.10.10.10 255.255.255.255 192.168.1.2 preference 50 track bfd-session 1</div><div class="line">在R2配置</div><div class="line">[R2]bfd</div><div class="line">[R2-bfd]bfd 1 bind peer-ip 192.168.1.1 source-ip 192.168.1.2 auto</div><div class="line">[R2-bfd-session-1]commit</div><div class="line">在路由器R1配置下面一半的BFD-session 2</div></pre></td></tr></table></figure>
<h2 id="二十一、虚拟路由器VRRP"><a href="#二十一、虚拟路由器VRRP" class="headerlink" title="二十一、虚拟路由器VRRP"></a>二十一、虚拟路由器VRRP</h2><p>50ms以内的数据转发才能称为高可靠性</p>
<p><img src="https://ws1.sinaimg.cn/large/786be24dly1fna4mcz9c3j20rs0ac75d.jpg" alt="VRRP"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[R1]display vrrp interface e 0/0/0  查看信息</div><div class="line">[R1-GigabitEthernet0/0/1]vrrp vrid 1 virtual-ip 192.168.1.100</div><div class="line">[R1-GigabitEthernet0/0/1]vrrp vrid 1 priority 200设置VRID1 的优先级为200 </div><div class="line">[R1-GigabitEthernet0/0/1]vrrp vrid 1 track interface GigabitEthernet 0/0/0 reduced 150</div><div class="line">[R1-GigabitEthernet0/0/1]vrrp vrid 2 virtual-ip 192.168.1.200</div><div class="line">R2上的配置</div><div class="line">[R2-GigabitEthernet0/0/1]vrrp vrid 1 virtual-ip 192.168.1.100</div><div class="line">[R2-GigabitEthernet0/0/1]vrrp vrid 2 virtual-ip 192.168.1.200</div><div class="line">[R2-GigabitEthernet0/0/1]vrrp vrid 2 priority 200 //设置VRID2 的优先级为200</div><div class="line">[R2-GigabitEthernet0/0/1]vrrp vrid 2 track interface GigabitEthernet 0/0/2 reduced 150</div></pre></td></tr></table></figure>
<p>## </p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/01/06/SSL-TLS/" rel="prev" title="SSL/TLS安全协议">
                SSL/TLS安全协议 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="DF104" />
          <p class="site-author-name" itemprop="name">DF104</p>
           
              <p class="site-description motion-element" itemprop="description">ChongQing,China</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/df104" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/2020336205?refer_flag=1005050008_&is_all=1" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                    
                      Weibo
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/li1042062797" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                    
                      Twitter
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=nfH0rK2pr62rr6qkqt3s7LP_8vA" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、基本知识"><span class="nav-number">1.</span> <span class="nav-text">一、基本知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基础操作"><span class="nav-number">1.1.</span> <span class="nav-text">基础操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#linux-权限位信息"><span class="nav-number">1.2.</span> <span class="nav-text">linux 权限位信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#华为系统基础命令"><span class="nav-number">1.3.</span> <span class="nav-text">华为系统基础命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、FTP的配置"><span class="nav-number">2.</span> <span class="nav-text">二、FTP的配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FTP文件传输协议"><span class="nav-number">2.1.</span> <span class="nav-text">FTP文件传输协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FTP基础命令"><span class="nav-number">2.2.</span> <span class="nav-text">FTP基础命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、FTP-Server的配置"><span class="nav-number">2.2.1.</span> <span class="nav-text">1、FTP Server的配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、FTP-Cilent的配置"><span class="nav-number">2.2.2.</span> <span class="nav-text">2、FTP Cilent的配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、Telnet的配置"><span class="nav-number">3.</span> <span class="nav-text">三、Telnet的配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#登录Telnet"><span class="nav-number">3.1.</span> <span class="nav-text">登录Telnet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#password模式"><span class="nav-number">3.2.</span> <span class="nav-text">password模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AAA模式"><span class="nav-number">3.3.</span> <span class="nav-text">AAA模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、控制台配置"><span class="nav-number">4.</span> <span class="nav-text">四、控制台配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#设置控制台密码"><span class="nav-number">4.1.</span> <span class="nav-text">设置控制台密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#设置超时时间"><span class="nav-number">4.2.</span> <span class="nav-text">设置超时时间</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、路由"><span class="nav-number">5.</span> <span class="nav-text">五、路由</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本概念"><span class="nav-number">5.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图表及命令"><span class="nav-number">5.2.</span> <span class="nav-text">图表及命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#静态路由的配置"><span class="nav-number">5.3.</span> <span class="nav-text">静态路由的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#默认路由的配置"><span class="nav-number">5.4.</span> <span class="nav-text">默认路由的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由汇总"><span class="nav-number">5.5.</span> <span class="nav-text">路由汇总</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RIP的配置"><span class="nav-number">5.6.</span> <span class="nav-text">RIP的配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置接口的附加度量值"><span class="nav-number">5.6.1.</span> <span class="nav-text">配置接口的附加度量值</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#背景信息"><span class="nav-number">5.6.1.1.</span> <span class="nav-text">背景信息</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OSPF的配置"><span class="nav-number">5.7.</span> <span class="nav-text">OSPF的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由引入（路由重发布）"><span class="nav-number">5.8.</span> <span class="nav-text">路由引入（路由重发布）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IS-IS配置"><span class="nav-number">5.9.</span> <span class="nav-text">IS-IS配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BGP配置"><span class="nav-number">5.10.</span> <span class="nav-text">BGP配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#六、DHCP-动态主机配置协议"><span class="nav-number">6.</span> <span class="nav-text">六、DHCP 动态主机配置协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#实现方式"><span class="nav-number">6.1.</span> <span class="nav-text">实现方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#地址池"><span class="nav-number">6.2.</span> <span class="nav-text">地址池</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由器DHCP配置"><span class="nav-number">6.3.</span> <span class="nav-text">路由器DHCP配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#接口地址池配置"><span class="nav-number">6.3.1.</span> <span class="nav-text">接口地址池配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#全局地址池配置"><span class="nav-number">6.3.2.</span> <span class="nav-text">全局地址池配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#客户端操作"><span class="nav-number">6.3.3.</span> <span class="nav-text">客户端操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由器DHCP中继的配置"><span class="nav-number">6.4.</span> <span class="nav-text">路由器DHCP中继的配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#七、VLAN-局域网（Virtual-Local-Area-Netwok）"><span class="nav-number">7.</span> <span class="nav-text">七、VLAN 局域网（Virtual Local Area Netwok）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#VLAN基本概念"><span class="nav-number">7.1.</span> <span class="nav-text">VLAN基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#网络隔离的方式"><span class="nav-number">7.1.1.</span> <span class="nav-text">网络隔离的方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#接口的链路类型"><span class="nav-number">7.1.2.</span> <span class="nav-text">接口的链路类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VLAN封装协议"><span class="nav-number">7.1.3.</span> <span class="nav-text">VLAN封装协议</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VLAN基本配置"><span class="nav-number">7.2.</span> <span class="nav-text">VLAN基本配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#VLAN基本命令"><span class="nav-number">7.2.1.</span> <span class="nav-text">VLAN基本命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#端口类型转换"><span class="nav-number">7.2.2.</span> <span class="nav-text">端口类型转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#定义端口组"><span class="nav-number">7.2.3.</span> <span class="nav-text">定义端口组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#中继链路的配置"><span class="nav-number">7.2.4.</span> <span class="nav-text">中继链路的配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VLAN的四种情况"><span class="nav-number">7.3.</span> <span class="nav-text">VLAN的四种情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个节点通讯的前提条件"><span class="nav-number">7.4.</span> <span class="nav-text">两个节点通讯的前提条件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#八、ACL访问控制列表"><span class="nav-number">8.</span> <span class="nav-text">八、ACL访问控制列表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本概念-1"><span class="nav-number">8.0.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分类"><span class="nav-number">8.0.2.</span> <span class="nav-text">分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#基本ACL语法"><span class="nav-number">8.0.3.</span> <span class="nav-text">基本ACL语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#高级ACL语法"><span class="nav-number">8.0.4.</span> <span class="nav-text">高级ACL语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#规则"><span class="nav-number">8.0.5.</span> <span class="nav-text">规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#访问列表的配置步骤"><span class="nav-number">8.0.6.</span> <span class="nav-text">访问列表的配置步骤</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#九、GVRP-通用VLAN注册协议"><span class="nav-number">9.</span> <span class="nav-text">九、GVRP 通用VLAN注册协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基础知识"><span class="nav-number">9.1.</span> <span class="nav-text">基础知识</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十、链路聚合"><span class="nav-number">10.</span> <span class="nav-text">十、链路聚合</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#模式"><span class="nav-number">10.1.</span> <span class="nav-text">模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#链路聚合基本配置"><span class="nav-number">10.2.</span> <span class="nav-text">链路聚合基本配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#交换机的链路聚合配置"><span class="nav-number">10.2.1.</span> <span class="nav-text">交换机的链路聚合配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#路由器链路聚合的配置"><span class="nav-number">10.2.2.</span> <span class="nav-text">路由器链路聚合的配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十一、STP，生成树"><span class="nav-number">11.</span> <span class="nav-text">十一、STP，生成树</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#STP的作用"><span class="nav-number">11.1.</span> <span class="nav-text">STP的作用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#树形结构的特点"><span class="nav-number">11.1.1.</span> <span class="nav-text">树形结构的特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#根网桥、根端口、指定端口"><span class="nav-number">11.1.2.</span> <span class="nav-text">根网桥、根端口、指定端口</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#选举依据"><span class="nav-number">11.2.</span> <span class="nav-text">选举依据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#生成树端口的状态"><span class="nav-number">11.3.</span> <span class="nav-text">生成树端口的状态</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#交换机端口的5种STP状态"><span class="nav-number">11.3.1.</span> <span class="nav-text">交换机端口的5种STP状态</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#STP的三种计时器"><span class="nav-number">11.4.</span> <span class="nav-text">STP的三种计时器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用MSTP（多生成树）完成常见组网需求配置"><span class="nav-number">11.5.</span> <span class="nav-text">使用MSTP（多生成树）完成常见组网需求配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十二、-GRE隧道配置"><span class="nav-number">12.</span> <span class="nav-text">十二、 GRE隧道配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十三、NAT网络地址转换"><span class="nav-number">13.</span> <span class="nav-text">十三、NAT网络地址转换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IP地址"><span class="nav-number">13.1.</span> <span class="nav-text">IP地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#转换类型"><span class="nav-number">13.2.</span> <span class="nav-text">转换类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EasyIP的配置"><span class="nav-number">13.3.</span> <span class="nav-text">EasyIP的配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十四、防火墙"><span class="nav-number">14.</span> <span class="nav-text">十四、防火墙</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#防火墙分类"><span class="nav-number">14.1.</span> <span class="nav-text">防火墙分类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#防火墙与路由器的区别"><span class="nav-number">14.2.</span> <span class="nav-text">防火墙与路由器的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#区域与接口的关系"><span class="nav-number">14.3.</span> <span class="nav-text">区域与接口的关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#区域"><span class="nav-number">14.4.</span> <span class="nav-text">区域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安全级别（优先级）"><span class="nav-number">14.5.</span> <span class="nav-text">安全级别（优先级）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方向"><span class="nav-number">14.6.</span> <span class="nav-text">方向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#策略及规则（防火墙进行数据转发的规则）"><span class="nav-number">14.7.</span> <span class="nav-text">策略及规则（防火墙进行数据转发的规则）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本配置"><span class="nav-number">14.8.</span> <span class="nav-text">基本配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#防火墙基础案例"><span class="nav-number">14.9.</span> <span class="nav-text">防火墙基础案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义策略"><span class="nav-number">14.10.</span> <span class="nav-text">自定义策略</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十五、Mux-VLAN"><span class="nav-number">15.</span> <span class="nav-text">十五、Mux VLAN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本概念-2"><span class="nav-number">15.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mux-VLAN的配置"><span class="nav-number">15.2.</span> <span class="nav-text">Mux VLAN的配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十六、端口隔离"><span class="nav-number">16.</span> <span class="nav-text">十六、端口隔离</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十七、ARP代理"><span class="nav-number">17.</span> <span class="nav-text">十七、ARP代理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ARP代理的配置"><span class="nav-number">17.1.</span> <span class="nav-text">ARP代理的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Super-VLAN的应用和配置"><span class="nav-number">17.2.</span> <span class="nav-text">Super VLAN的应用和配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十八、路由器ARP代理"><span class="nav-number">18.</span> <span class="nav-text">十八、路由器ARP代理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十九、策略路由"><span class="nav-number">19.</span> <span class="nav-text">十九、策略路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二十、BFD的配置"><span class="nav-number">20.</span> <span class="nav-text">二十、BFD的配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十九、策略路由-1"><span class="nav-number">21.</span> <span class="nav-text">十九、策略路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二十、BFD的配置-1"><span class="nav-number">22.</span> <span class="nav-text">二十、BFD的配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二十一、虚拟路由器VRRP"><span class="nav-number">23.</span> <span class="nav-text">二十一、虚拟路由器VRRP</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Powered By DF104</span>
</div>


<div class="powered-by">
   个人专属
</div>

<div class="theme-info">
  博客 -DF104
</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

<!-- 小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<!--卖萌-->
<script type="text/javascript" src="/js/src/dytitle.js"></script>

  </body>
</html>
